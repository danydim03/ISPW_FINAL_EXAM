<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<!--
    Vista per lo Use Case "Crea Ordine"
    Controller: org.example.use_cases.crea_ordine.graphic_controllers.CreaOrdineGUIController
    Stile: Card-based design coerente con homepage_Cliente2.fxml
-->

<AnchorPane prefHeight="550.0" prefWidth="850.0" styleClass="background" stylesheets="@styles/crea-ordine-style.css" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.example.use_cases.crea_ordine.graphic_controllers.CreaOrdineGUIController">

    <!-- Intestazione -->
    <VBox AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20" AnchorPane.topAnchor="10">
        <HBox alignment="CENTER_LEFT" spacing="15">
            <ImageView fitHeight="40" fitWidth="40" preserveRatio="true">
                <Image url="@images/kebab1.png" />
            </ImageView>
            <VBox>
                <Label fx:id="labelNumeroOrdine" styleClass="page-title" text="Nuovo Ordine" />
                <Text styleClass="page-subtitle" text="Componi il tuo ordine perfetto" />
            </VBox>
        </HBox>
    </VBox>

    <!-- Layout principale a 2 colonne -->
    <HBox spacing="20" AnchorPane.bottomAnchor="20" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20" AnchorPane.topAnchor="70">

        <!-- ==================== COLONNA SINISTRA: Selezione Prodotti ==================== -->
        <VBox prefWidth="400" spacing="15" styleClass="card-container">

            <!-- Card: Seleziona Prodotto Base -->
            <AnchorPane prefHeight="180" styleClass="card">
                <!-- Header Card con immagine -->
                <ImageView fitHeight="80" fitWidth="400" preserveRatio="false" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">
                    <Image url="@images/habibi_banner.png" />
                </ImageView>

                <!-- Contenuto Card -->
                <VBox spacing="10" AnchorPane.bottomAnchor="10" AnchorPane.leftAnchor="15" AnchorPane.rightAnchor="15" AnchorPane.topAnchor="85">
                    <Label styleClass="card-title" text="ðŸ¥™ Scegli il Prodotto Base" />
                    <ComboBox fx:id="comboProdottoBase" prefWidth="360" promptText="Seleziona un prodotto..." styleClass="combo-box-custom" />
                </VBox>
            </AnchorPane>

            <!-- Card: Seleziona Add-On -->
            <AnchorPane prefHeight="200" styleClass="card">
                <VBox spacing="12" AnchorPane.bottomAnchor="15" AnchorPane.leftAnchor="15" AnchorPane.rightAnchor="15" AnchorPane.topAnchor="15">
                    <Label styleClass="card-title" text="ðŸ§… Aggiungi Extra" />
                    <Text styleClass="card-description" text="Personalizza il tuo ordine con gli add-on" />

                    <GridPane hgap="15" vgap="10">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="50" />
                            <ColumnConstraints percentWidth="50" />
                        </columnConstraints>
                        <rowConstraints>
                            <RowConstraints />
                            <RowConstraints />
                        </rowConstraints>

                        <!-- Riga 1 -->
                        <CheckBox fx:id="checkCipolla" styleClass="addon-checkbox" text="ðŸ§… Cipolla (+â‚¬0.50)" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                        <CheckBox fx:id="checkSalsaYogurt" styleClass="addon-checkbox" text="ðŸ¥› Salsa Yogurt (+â‚¬0.80)" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                        <!-- Riga 2 -->
                        <CheckBox fx:id="checkPatatine" styleClass="addon-checkbox" text="ðŸŸ Patatine (+â‚¬2.00)" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                        <CheckBox fx:id="checkMixVerdure" styleClass="addon-checkbox" text="ðŸ¥— Mix Verdure (+â‚¬1.50)" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                    </GridPane>

                    <!-- Bottone Aggiungi -->
                    <HBox alignment="CENTER_RIGHT">
                        <Button fx:id="btnAggiungiProdotto" onAction="#onAggiungiProdotto" styleClass="action-button-primary" text="âž• Aggiungi all'Ordine" />
                    </HBox>
                </VBox>
            </AnchorPane>

            <!-- Card: Voucher Sconto -->
            <AnchorPane prefHeight="130" styleClass="card">
                <VBox spacing="10" AnchorPane.bottomAnchor="15" AnchorPane.leftAnchor="15" AnchorPane.rightAnchor="15" AnchorPane.topAnchor="15">
                    <Label styleClass="card-title" text="ðŸŽ« Hai un Voucher?" />

                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <TextField fx:id="textFieldVoucher" prefWidth="220" promptText="Inserisci codice voucher..." styleClass="text-field" />
                        <Button fx:id="btnApplicaVoucher" onAction="#onApplicaVoucher" styleClass="action-button" text="Applica" />
                        <Button fx:id="btnRimuoviVoucher" onAction="#onRimuoviVoucher" styleClass="remove-button" text="âœ•" />
                    </HBox>

                    <!-- Info voucher applicato -->
                    <Label fx:id="labelVoucherInfo" styleClass="voucher-info" text="" />
                </VBox>
            </AnchorPane>
        </VBox>

        <!-- ==================== COLONNA DESTRA: Riepilogo Ordine ==================== -->
        <VBox prefWidth="400" spacing="15" styleClass="card-container" HBox.hgrow="ALWAYS">

            <!-- Card: Riepilogo Ordine -->
            <AnchorPane styleClass="card" VBox.vgrow="ALWAYS">
                <VBox spacing="10" AnchorPane.bottomAnchor="15" AnchorPane.leftAnchor="15" AnchorPane.rightAnchor="15" AnchorPane.topAnchor="15">

                    <!-- Header Riepilogo -->
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label styleClass="card-title" text="ðŸ“‹ Il Tuo Ordine" />
                        <Region HBox.hgrow="ALWAYS" />
                        <Button fx:id="btnRimuoviProdotto" onAction="#onRimuoviProdotto" styleClass="remove-button-small" text="ðŸ—‘ï¸ Rimuovi" />
                    </HBox>

                    <!-- Tabella Prodotti -->
                    <ScrollPane fitToWidth="true" styleClass="table-scroll" VBox.vgrow="ALWAYS">
                        <TableView fx:id="tabellaOrdine" styleClass="order-table">
                            <columns>
                                <TableColumn fx:id="colonnaDescrizione" prefWidth="220" text="Prodotto" />
                                <TableColumn fx:id="colonnaPrezzo" prefWidth="80" text="Prezzo" />
                                <TableColumn fx:id="colonnaDurata" prefWidth="60" text="Tempo" />
                            </columns>
                            <placeholder>
                                <Label styleClass="placeholder-text" text="ðŸ›’ Il carrello Ã¨ vuoto" />
                            </placeholder>
                        </TableView>
                    </ScrollPane>

                    <!-- Separatore -->
                    <Separator />

                    <!-- Totali -->
                    <VBox spacing="8" styleClass="totals-container">
                        <!-- Subtotale -->
                        <HBox alignment="CENTER_LEFT">
                            <Label styleClass="total-label" text="Subtotale:" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label fx:id="labelSubtotale" styleClass="total-value" text="â‚¬0.00" />
                        </HBox>

                        <!-- Sconto (visibile solo se voucher applicato) -->
                        <HBox fx:id="panelSconto" alignment="CENTER_LEFT" managed="false" visible="false">
                            <Label styleClass="total-label discount-label" text="Sconto:" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label fx:id="labelSconto" styleClass="total-value discount-value" text="-â‚¬0.00" />
                        </HBox>

                        <!-- Separatore sottile -->
                        <Separator styleClass="thin-separator" />

                        <!-- Totale Finale -->
                        <HBox alignment="CENTER_LEFT">
                            <Label styleClass="total-label-big" text="TOTALE:" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label fx:id="labelTotale" styleClass="total-value-big" text="â‚¬0.00" />
                        </HBox>

                        <!-- Tempo di preparazione -->
                        <HBox alignment="CENTER_LEFT">
                            <Label styleClass="time-label" text="â±ï¸ Tempo stimato:" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Label fx:id="labelDurata" styleClass="time-value" text="0 min" />
                        </HBox>
                    </VBox>
                </VBox>
            </AnchorPane>

            <!-- Bottoni Azione -->
            <HBox alignment="CENTER" spacing="15">
                <Button fx:id="btnAnnullaOrdine" maxWidth="Infinity" onAction="#onAnnullaOrdine" styleClass="cancel-button" text="ðŸš« Annulla Ordine" HBox.hgrow="ALWAYS" />
                <Button fx:id="btnConfermaOrdine" maxWidth="Infinity" onAction="#onConfermaOrdine" styleClass="confirm-button" text="âœ… Conferma Ordine" HBox.hgrow="ALWAYS" />
            </HBox>
        </VBox>
    </HBox>

</AnchorPane>
