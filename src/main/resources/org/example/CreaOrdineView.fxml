<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Text?>

<!--
    Vista per lo Use Case "Crea Ordine"
    Controller: org.example.use_cases.crea_ordine.graphic_controllers.CreaOrdineGUIController
    Stile: Card-based design coerente con homepage_Cliente2.fxml
-->
<AnchorPane prefHeight="550.0" prefWidth="850.0"
            stylesheets="@styles/crea-ordine-style.css"
            styleClass="background"
            xmlns="http://javafx.com/javafx/17"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="org.example.use_cases.crea_ordine.graphic_controllers.CreaOrdineGUIController">

    <!-- Intestazione -->
    <VBox AnchorPane.topAnchor="10" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20">
        <HBox alignment="CENTER_LEFT" spacing="15">
            <ImageView fitHeight="40" fitWidth="40" preserveRatio="true">
                <Image url="@images/kebab1.png"/>
            </ImageView>
            <VBox>
                <Label fx:id="labelNumeroOrdine" text="Nuovo Ordine" styleClass="page-title"/>
                <Text text="Componi il tuo ordine perfetto" styleClass="page-subtitle"/>
            </VBox>
        </HBox>
    </VBox>

    <!-- Layout principale a 2 colonne -->
    <HBox AnchorPane.topAnchor="70" AnchorPane.bottomAnchor="20"
          AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20" spacing="20">

        <!-- ==================== COLONNA SINISTRA: Selezione Prodotti ==================== -->
        <VBox prefWidth="400" spacing="15" styleClass="card-container">

            <!-- Card: Seleziona Prodotto Base -->
            <AnchorPane styleClass="card" prefHeight="180">
                <!-- Header Card con immagine -->
                <ImageView fitHeight="80" fitWidth="400" preserveRatio="false"
                           AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0" AnchorPane.topAnchor="0">
                    <Image url="@images/habibi_banner.png"/>
                </ImageView>

                <!-- Contenuto Card -->
                <VBox AnchorPane.topAnchor="85" AnchorPane.leftAnchor="15"
                      AnchorPane.rightAnchor="15" AnchorPane.bottomAnchor="10" spacing="10">
                    <Label text="ðŸ¥™ Scegli il Prodotto Base" styleClass="card-title"/>
                    <ComboBox fx:id="comboProdottoBase" prefWidth="360" promptText="Seleziona un prodotto..."
                              styleClass="combo-box-custom"/>
                </VBox>
            </AnchorPane>

            <!-- Card: Seleziona Add-On -->
            <AnchorPane styleClass="card" prefHeight="200">
                <VBox AnchorPane.topAnchor="15" AnchorPane.leftAnchor="15"
                      AnchorPane.rightAnchor="15" AnchorPane.bottomAnchor="15" spacing="12">
                    <Label text="ðŸ§… Aggiungi Extra" styleClass="card-title"/>
                    <Text text="Personalizza il tuo ordine con gli add-on" styleClass="card-description"/>

                    <GridPane hgap="15" vgap="10">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="50"/>
                            <ColumnConstraints percentWidth="50"/>
                        </columnConstraints>
                        <rowConstraints>
                            <RowConstraints/>
                            <RowConstraints/>
                        </rowConstraints>

                        <!-- Riga 1 -->
                        <CheckBox fx:id="checkCipolla" text="ðŸ§… Cipolla (+â‚¬0.50)"
                                  styleClass="addon-checkbox" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <CheckBox fx:id="checkSalsaYogurt" text="ðŸ¥› Salsa Yogurt (+â‚¬0.80)"
                                  styleClass="addon-checkbox" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                        <!-- Riga 2 -->
                        <CheckBox fx:id="checkPatatine" text="ðŸŸ Patatine (+â‚¬2.00)"
                                  styleClass="addon-checkbox" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <CheckBox fx:id="checkMixVerdure" text="ðŸ¥— Mix Verdure (+â‚¬1.50)"
                                  styleClass="addon-checkbox" GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                    </GridPane>

                    <!-- Bottone Aggiungi -->
                    <HBox alignment="CENTER_RIGHT">
                        <Button fx:id="btnAggiungiProdotto" text="âž• Aggiungi all'Ordine"
                                onAction="#onAggiungiProdotto" styleClass="action-button-primary"/>
                    </HBox>
                </VBox>
            </AnchorPane>

            <!-- Card: Voucher Sconto -->
            <AnchorPane styleClass="card" prefHeight="130">
                <VBox AnchorPane.topAnchor="15" AnchorPane.leftAnchor="15"
                      AnchorPane.rightAnchor="15" AnchorPane.bottomAnchor="15" spacing="10">
                    <Label text="ðŸŽ« Hai un Voucher?" styleClass="card-title"/>

                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <TextField fx:id="textFieldVoucher" promptText="Inserisci codice voucher..."
                                   prefWidth="220" styleClass="text-field"/>
                        <Button fx:id="btnApplicaVoucher" text="Applica"
                                onAction="#onApplicaVoucher" styleClass="action-button"/>
                        <Button fx:id="btnRimuoviVoucher" text="âœ•"
                                onAction="#onRimuoviVoucher" styleClass="remove-button"/>
                    </HBox>

                    <!-- Info voucher applicato -->
                    <Label fx:id="labelVoucherInfo" text="" styleClass="voucher-info"/>
                </VBox>
            </AnchorPane>
        </VBox>

        <!-- ==================== COLONNA DESTRA: Riepilogo Ordine ==================== -->
        <VBox prefWidth="400" spacing="15" styleClass="card-container" HBox.hgrow="ALWAYS">

            <!-- Card: Riepilogo Ordine -->
            <AnchorPane styleClass="card" VBox.vgrow="ALWAYS">
                <VBox AnchorPane.topAnchor="15" AnchorPane.leftAnchor="15"
                      AnchorPane.rightAnchor="15" AnchorPane.bottomAnchor="15" spacing="10">

                    <!-- Header Riepilogo -->
                    <HBox alignment="CENTER_LEFT" spacing="10">
                        <Label text="ðŸ“‹ Il Tuo Ordine" styleClass="card-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button fx:id="btnRimuoviProdotto" text="ðŸ—‘ï¸ Rimuovi"
                                onAction="#onRimuoviProdotto" styleClass="remove-button-small"/>
                    </HBox>

                    <!-- Tabella Prodotti -->
                    <ScrollPane fitToWidth="true" VBox.vgrow="ALWAYS" styleClass="table-scroll">
                        <TableView fx:id="tabellaOrdine" styleClass="order-table">
                            <columns>
                                <TableColumn fx:id="colonnaDescrizione" text="Prodotto" prefWidth="220"/>
                                <TableColumn fx:id="colonnaPrezzo" text="Prezzo" prefWidth="80"/>
                                <TableColumn fx:id="colonnaDurata" text="Tempo" prefWidth="60"/>
                            </columns>
                            <placeholder>
                                <Label text="ðŸ›’ Il carrello Ã¨ vuoto" styleClass="placeholder-text"/>
                            </placeholder>
                        </TableView>
                    </ScrollPane>

                    <!-- Separatore -->
                    <Separator/>

                    <!-- Totali -->
                    <VBox spacing="8" styleClass="totals-container">
                        <!-- Subtotale -->
                        <HBox alignment="CENTER_LEFT">
                            <Label text="Subtotale:" styleClass="total-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="labelSubtotale" text="â‚¬0.00" styleClass="total-value"/>
                        </HBox>

                        <!-- Sconto (visibile solo se voucher applicato) -->
                        <HBox fx:id="panelSconto" alignment="CENTER_LEFT" visible="false" managed="false">
                            <Label text="Sconto:" styleClass="total-label discount-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="labelSconto" text="-â‚¬0.00" styleClass="total-value discount-value"/>
                        </HBox>

                        <!-- Separatore sottile -->
                        <Separator styleClass="thin-separator"/>

                        <!-- Totale Finale -->
                        <HBox alignment="CENTER_LEFT">
                            <Label text="TOTALE:" styleClass="total-label-big"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="labelTotale" text="â‚¬0.00" styleClass="total-value-big"/>
                        </HBox>

                        <!-- Tempo di preparazione -->
                        <HBox alignment="CENTER_LEFT">
                            <Label text="â±ï¸ Tempo stimato:" styleClass="time-label"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="labelDurata" text="0 min" styleClass="time-value"/>
                        </HBox>
                    </VBox>
                </VBox>
            </AnchorPane>

            <!-- Bottoni Azione -->
            <HBox spacing="15" alignment="CENTER">
                <Button fx:id="btnAnnullaOrdine" text="ðŸš« Annulla Ordine"
                        onAction="#onAnnullaOrdine" styleClass="cancel-button" HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
                <Button fx:id="btnConfermaOrdine" text="âœ… Conferma Ordine"
                        onAction="#onConfermaOrdine" styleClass="confirm-button" HBox.hgrow="ALWAYS" maxWidth="Infinity"/>
            </HBox>
        </VBox>
    </HBox>
</AnchorPane>